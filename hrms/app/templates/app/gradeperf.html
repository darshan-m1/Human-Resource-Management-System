{% extends 'app/base.html' %}
{% block content %}
<div class="page-header d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="mb-1 gradient-text">Grade Performance Review</h1>
        <p class="text-muted mb-0">Provide feedback and ratings for employee performance</p>
    </div>
    <a href="{% url 'app:perflist' %}" class="btn btn-outline-secondary hover-lift">
        <i class="bi bi-arrow-left me-2"></i>Back to List
    </a>
</div>

<div class="row">
    <div class="col-lg-10 mx-auto">
        <!-- Employee Information Card -->
        <div class="glass-card p-4 mb-4">
            <div class="d-flex align-items-center">
                <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                    <i class="bi bi-person-badge text-primary fs-2"></i>
                </div>
                <div class="flex-grow-1">
                    <h3 class="mb-1">{{ object.employee.user.get_full_name }}</h3>
                    <div class="d-flex flex-wrap gap-3">
                        <span class="badge bg-primary bg-opacity-10 text-primary">
                            <i class="bi bi-briefcase me-1"></i>{{ object.employee.get_role_display }}
                        </span>
                        <span class="badge bg-success bg-opacity-10 text-success">
                            <i class="bi bi-building me-1"></i>{{ object.employee.department.name }}
                        </span>
                        {% if object.employee.reporting_to %}
                        <span class="badge bg-info bg-opacity-10 text-info">
                            <i class="bi bi-person-check me-1"></i>Reports to: {{ object.employee.reporting_to.user.get_full_name }}
                        </span>
                        {% endif %}
                    </div>
                </div>
                <div class="text-end">
                    <div class="badge bg-warning bg-opacity-10 text-warning p-2 rounded-pill">
                        <i class="bi bi-clipboard-check me-1"></i>
                        Review Pending
                    </div>
                </div>
            </div>
        </div>

        <!-- Rating Guide -->
        <div class="glass-card p-4 mb-4">
            <h5 class="mb-3 d-flex align-items-center">
                <i class="bi bi-speedometer2 text-primary me-2"></i>Rating Guide
            </h5>
            <div class="row g-3">
                <div class="col-md-3">
                    <div class="text-center p-3 bg-light rounded">
                        <div class="rating-circle rating-excellent mb-2 mx-auto">5</div>
                        <h6 class="mb-1">Excellent</h6>
                        <p class="text-muted small mb-0">Consistently exceeds expectations</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 bg-light rounded">
                        <div class="rating-circle rating-good mb-2 mx-auto">4</div>
                        <h6 class="mb-1">Good</h6>
                        <p class="text-muted small mb-0">Frequently exceeds expectations</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 bg-light rounded">
                        <div class="rating-circle rating-average mb-2 mx-auto">2.5</div>
                        <h6 class="mb-1">Average</h6>
                        <p class="text-muted small mb-0">Meets all expectations</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 bg-light rounded">
                        <div class="rating-circle rating-poor mb-2 mx-auto">1</div>
                        <h6 class="mb-1">Needs Work</h6>
                        <p class="text-muted small mb-0">Below expectations</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grading Form -->
        <div class="glass-card p-4">
            <form method="POST">
                {% csrf_token %}
                
                <!-- Section 1: Responsibilities -->
                <div class="glass-card p-4 mb-4 hover-lift">
                    <div class="d-flex align-items-center mb-4">
                        <div class="rounded-circle bg-primary bg-opacity-10 p-2 me-3">
                            <span class="badge bg-primary rounded-circle p-2">1</span>
                        </div>
                        <div>
                            <h4 class="mb-0">Responsibilities</h4>
                            <p class="text-muted mb-0">Key responsibilities and accomplishments</p>
                        </div>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-journal-text text-primary me-2"></i>
                                    Employee's Description
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.responsibilities|linebreaks|default:"No description provided" }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-person-circle text-primary me-2"></i>
                                    Employee's Self-Review
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.responsibility_self_review|linebreaks|default:"No self-review provided" }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-top pt-4 mt-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-star text-warning me-2"></i>
                            Your Rating (0.0 - 5.0):
                        </label>
                        <div class="input-group">
                            <span class="input-group-text bg-light">
                                <i class="bi bi-graph-up text-muted"></i>
                            </span>
                            {{ form.responsibility_rating }}
                            <span class="input-group-text">/5.0</span>
                        </div>
                        <small class="form-text text-muted d-flex align-items-center mt-2">
                            <i class="bi bi-lightbulb text-warning me-1"></i>
                            0 = Poor, 2.5 = Average, 5 = Excellent
                        </small>
                    </div>
                </div>

                <!-- Section 2: Communication -->
                <div class="glass-card p-4 mb-4 hover-lift">
                    <div class="d-flex align-items-center mb-4">
                        <div class="rounded-circle bg-success bg-opacity-10 p-2 me-3">
                            <span class="badge bg-success rounded-circle p-2">2</span>
                        </div>
                        <div>
                            <h4 class="mb-0">Communication</h4>
                            <p class="text-muted mb-0">Team and stakeholder communication</p>
                        </div>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-megaphone text-success me-2"></i>
                                    Employee's Description
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.communication|linebreaks|default:"No description provided" }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-person-check text-success me-2"></i>
                                    Employee's Self-Review
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.communication_self_review|linebreaks|default:"No self-review provided" }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-top pt-4 mt-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-star text-warning me-2"></i>
                            Your Rating (0.0 - 5.0):
                        </label>
                        <div class="input-group">
                            <span class="input-group-text bg-light">
                                <i class="bi bi-chat-left-text text-muted"></i>
                            </span>
                            {{ form.communication_rating }}
                            <span class="input-group-text">/5.0</span>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Quality of Work -->
                <div class="glass-card p-4 mb-4 hover-lift">
                    <div class="d-flex align-items-center mb-4">
                        <div class="rounded-circle bg-info bg-opacity-10 p-2 me-3">
                            <span class="badge bg-info rounded-circle p-2">3</span>
                        </div>
                        <div>
                            <h4 class="mb-0">Quality of Work</h4>
                            <p class="text-muted mb-0">Work standards and quality assurance</p>
                        </div>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-award text-info me-2"></i>
                                    Employee's Description
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.quality|linebreaks|default:"No description provided" }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-check-all text-info me-2"></i>
                                    Employee's Self-Review
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.quality_self_review|linebreaks|default:"No self-review provided" }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-top pt-4 mt-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-star text-warning me-2"></i>
                            Your Rating (0.0 - 5.0):
                        </label>
                        <div class="input-group">
                            <span class="input-group-text bg-light">
                                <i class="bi bi-check-square text-muted"></i>
                            </span>
                            {{ form.quality_rating }}
                            <span class="input-group-text">/5.0</span>
                        </div>
                    </div>
                </div>

                <!-- Section 4: Accountability -->
                <div class="glass-card p-4 mb-4 hover-lift">
                    <div class="d-flex align-items-center mb-4">
                        <div class="rounded-circle bg-warning bg-opacity-10 p-2 me-3">
                            <span class="badge bg-warning rounded-circle p-2">4</span>
                        </div>
                        <div>
                            <h4 class="mb-0">Accountability</h4>
                            <p class="text-muted mb-0">Ownership and responsibility</p>
                        </div>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-shield-check text-warning me-2"></i>
                                    Employee's Description
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.accountability|linebreaks|default:"No description provided" }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-person-workspace text-warning me-2"></i>
                                    Employee's Self-Review
                                </label>
                                <div class="bg-light p-3 rounded fst-italic">
                                    {{ object.accountability_self_review|linebreaks|default:"No self-review provided" }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-top pt-4 mt-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-star text-warning me-2"></i>
                            Your Rating (0.0 - 5.0):
                        </label>
                        <div class="input-group">
                            <span class="input-group-text bg-light">
                                <i class="bi bi-shield-check text-muted"></i>
                            </span>
                            {{ form.accountability_rating }}
                            <span class="input-group-text">/5.0</span>
                        </div>
                    </div>
                </div>

                <!-- Overall Feedback -->
                <div class="glass-card p-4 mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="rounded-circle bg-dark bg-opacity-10 p-2 me-3">
                            <i class="bi bi-chat-left-text text-dark"></i>
                        </div>
                        <div>
                            <h4 class="mb-0">Overall Feedback</h4>
                            <p class="text-muted mb-0">Provide comprehensive feedback and comments</p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-pencil text-primary me-2"></i>
                            Your Comments & Feedback:
                        </label>
                        <div class="input-group">
                            <span class="input-group-text bg-light align-items-start">
                                <i class="bi bi-chat-quote text-muted mt-1"></i>
                            </span>
                            {{ form.comments }}
                        </div>
                        <small class="form-text text-muted d-flex align-items-center mt-2">
                            <i class="bi bi-lightbulb text-warning me-1"></i>
                            Provide overall feedback, highlight strengths, and suggest areas for improvement
                        </small>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="border-top pt-4 mt-4">
                    <div class="d-flex justify-content-between">
                        <a href="{% url 'app:perflist' %}" class="btn btn-outline-danger px-4">
                            <i class="bi bi-x-circle me-2"></i>Cancel
                        </a>
                        <div class="d-flex gap-2">
                            <button type="reset" class="btn btn-outline-secondary px-4">
                                <i class="bi bi-arrow-clockwise me-2"></i>Reset Form
                            </button>
                            <button type="submit" class="btn gradient-btn px-4">
                                <i class="bi bi-send-check me-2"></i>Submit Grades & Feedback
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Grading Tips -->
        <div class="glass-card p-4 mt-4">
            <h5 class="mb-4"><i class="bi bi-lightbulb text-warning me-2"></i>Grading Guidelines</h5>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="d-flex">
                        <div class="rounded-circle bg-success bg-opacity-10 p-2 me-3 flex-shrink-0">
                            <i class="bi bi-check-lg text-success"></i>
                        </div>
                        <div>
                            <h6 class="mb-2">Be Objective</h6>
                            <p class="text-muted small mb-0">Base ratings on observable behaviors and measurable outcomes.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex">
                        <div class="rounded-circle bg-primary bg-opacity-10 p-2 me-3 flex-shrink-0">
                            <i class="bi bi-check-lg text-primary"></i>
                        </div>
                        <div>
                            <h6 class="mb-2">Provide Evidence</h6>
                            <p class="text-muted small mb-0">Reference specific examples to support your ratings.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex">
                        <div class="rounded-circle bg-warning bg-opacity-10 p-2 me-3 flex-shrink-0">
                            <i class="bi bi-check-lg text-warning"></i>
                        </div>
                        <div>
                            <h6 class="mb-2">Focus on Growth</h6>
                            <p class="text-muted small mb-0">Offer constructive feedback that supports development.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="d-flex">
                        <div class="rounded-circle bg-info bg-opacity-10 p-2 me-3 flex-shrink-0">
                            <i class="bi bi-check-lg text-info"></i>
                        </div>
                        <div>
                            <h6 class="mb-2">Balance Feedback</h6>
                            <p class="text-muted small mb-0">Acknowledge strengths while addressing areas for improvement.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="d-flex">
                        <div class="rounded-circle bg-danger bg-opacity-10 p-2 me-3 flex-shrink-0">
                            <i class="bi bi-check-lg text-danger"></i>
                        </div>
                        <div>
                            <h6 class="mb-2">Timely Review</h6>
                            <p class="text-muted small mb-0">Complete reviews promptly to ensure timely feedback.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}